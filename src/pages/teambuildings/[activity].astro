---
import Layout from '@/layouts/Layout.astro';
import { getCollection } from 'astro:content';
import ActivityCard from '@/components/TeamActivities/ActivityCard.astro';

// Get the category ID from the URL
const { activity: categoryId } = Astro.params;

// Get all activities that belong to this category
const activities = await getCollection('activities');
const categoryActivities = activities.filter((activity) =>
  activity.data.categories.includes(categoryId)
);

// Get the category details
const categories = await getCollection('categories');
const category = categories.find((cat) => cat.id === categoryId);

if (!category) {
  return Astro.redirect('/404');
}
---

<Layout title={`${category.data.title} Teambuilding Activities - ActionMaker`}>
  {/* Hero Section */}
  <section class="relative min-h-[40vh] flex items-center">
    <div class="absolute inset-0 z-0">
      <img src={category.data.image} alt={category.data.title} class="w-full h-full object-cover" />
      <div class="absolute inset-0 bg-gradient-to-r from-black/70 via-black/60 to-transparent">
      </div>
    </div>

    <div class="relative z-10 max-w-7xl mx-auto px-4 py-24">
      <h1 class="text-4xl md:text-6xl font-bold text-white mb-6">
        {category.data.title}
      </h1>
      <p class="text-xl text-white/90 max-w-2xl">
        {category.data.description}
      </p>
    </div>
  </section>

  <section class="max-w-7xl mx-auto px-4 py-12">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {
        categoryActivities.map((activity) => (
          <ActivityCard
            title={activity.data.title}
            description={activity.data.description}
            image={activity.data.image}
            duration={activity.data.duration}
            groupSize={activity.data.groupSize}
            href={`/activities/${activity.id}`}
          />
        ))
      }
    </div>

    {
      categoryActivities.length === 0 && (
        <div class="text-center py-12">
          <p class="text-xl text-muted-foreground">Geen activiteiten gevonden in deze categorie.</p>
        </div>
      )
    }
  </section>
</Layout>
