---
import { Phone, Mail, Facebook, Instagram } from 'lucide-react';
import { getLangFromUrl, useTranslations } from '@/i18n/utils';
import { footerLinks } from './footer-data';
import { getCollection } from 'astro:content';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// Get all activities to map their titles
const activities = await getCollection('activities', ({ id }) => {
  return id.startsWith(`${lang}/`);
});

// Create a map of activity IDs to their titles
const activityTitles = new Map(
  activities.map((activity) => [
    activity.id.split('/').pop()?.replace('.md', ''),
    activity.data.title,
  ])
);
---

<footer class="bg-black text-zinc-200">
  <div class="max-w-7xl mx-auto px-4 py-16">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-8">
      {/* Company Info */}
      <div class="lg:col-span-2">
        <h3 class="font-semibold mb-4">ActionMaker</h3>
        <div class="mt-6 space-y-2">
          <p class="text-sm">Action Maker BVBA</p>
          <p class="text-sm">Hundelgemsesteenweg 445 A</p>
          <p class="text-sm">9050 Gentbrugge</p>
          <p class="text-sm">IBAN: BE74 3631 8185 2307</p>
          <p class="text-sm">BTW: BE0716509976</p>
        </div>
        <div class="mt-6 space-y-3">
          <a
            href="tel:+32476960657"
            class="flex items-center text-sm hover:text-white transition-colors"
          >
            <Phone className="h-4 w-4 mr-2" />
            +32 476 96 06 57
          </a>
          <a
            href="mailto:info@actionmaker.be"
            class="flex items-center text-sm hover:text-white transition-colors"
          >
            <Mail className="h-4 w-4 mr-2" />
            info@actionmaker.be
          </a>
        </div>
        <div class="mt-6 flex space-x-4">
          <a
            href="https://www.facebook.com/ActionMaker.be"
            target="_blank"
            rel="noopener noreferrer"
            class="text-zinc-400 hover:text-white transition-colors"
          >
            <Facebook className="h-5 w-5" />
          </a>
          <a
            href="https://www.instagram.com/action.maker/"
            target="_blank"
            rel="noopener noreferrer"
            class="text-zinc-400 hover:text-white transition-colors"
          >
            <Instagram className="h-5 w-5" />
          </a>
        </div>
      </div>

      {/* Navigation Links */}
      <div class="lg:col-span-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        {
          footerLinks.slice(0, 2).map((section) => (
            <div>
              <h3 class="font-semibold mb-4">{t(section.title as keyof typeof ui.nl)}</h3>
              <ul class="space-y-2 text-sm">
                {section.links.map((link) => {
                  const activityId = link.url.split('/').pop() || '';
                  const title = activityTitles.get(activityId);
                  const localizedUrl = lang === 'nl' ? link.url : `/${lang}${link.url}`;
                  return (
                    <li>
                      <a href={localizedUrl} class="hover:text-white transition-colors">
                        {title}
                      </a>
                    </li>
                  );
                })}
              </ul>
            </div>
          ))
        }

        {/* Actief + City Games */}
        <div class="space-y-12">
          {
            footerLinks.slice(2, 3).map((section) => (
              <div>
                <h3 class="font-semibold mb-4">{t(section.title as keyof typeof ui.nl)}</h3>
                <ul class="space-y-2 text-sm">
                  {section.links.map((link) => {
                    const activityId = link.url.split('/').pop() || '';
                    const title = activityTitles.get(activityId);
                    const localizedUrl = lang === 'nl' ? link.url : `/${lang}${link.url}`;
                    return (
                      <li>
                        <a href={localizedUrl} class="hover:text-white transition-colors">
                          {title}
                        </a>
                      </li>
                    );
                  })}
                </ul>
              </div>
            ))
          }
          {
            footerLinks.slice(4, 5).map((section) => (
              <div>
                <h3 class="font-semibold mb-4">{t(section.title as keyof typeof ui.nl)}</h3>
                <ul class="space-y-2 text-sm">
                  {section.links.map((link) => {
                    const activityId = link.url.split('/').pop() || '';
                    const title = activityTitles.get(activityId);
                    const localizedUrl = lang === 'nl' ? link.url : `/${lang}${link.url}`;
                    return (
                      <li>
                        <a href={localizedUrl} class="hover:text-white transition-colors">
                          {title}
                        </a>
                      </li>
                    );
                  })}
                </ul>
              </div>
            ))
          }
        </div>

        {/* InnovAction + Workshops */}
        <div class="space-y-12">
          {
            footerLinks.slice(3, 4).map((section) => (
              <div>
                <h3 class="font-semibold mb-4">{t(section.title as keyof typeof ui.nl)}</h3>
                <ul class="space-y-2 text-sm">
                  {section.links.map((link) => {
                    const activityId = link.url.split('/').pop() || '';
                    const title = activityTitles.get(activityId);
                    const localizedUrl = lang === 'nl' ? link.url : `/${lang}${link.url}`;
                    return (
                      <li>
                        <a href={localizedUrl} class="hover:text-white transition-colors">
                          {title}
                        </a>
                      </li>
                    );
                  })}
                </ul>
              </div>
            ))
          }
          {
            footerLinks.slice(5).map((section) => (
              <div>
                <h3 class="font-semibold mb-4">{t(section.title as keyof typeof ui.nl)}</h3>
                <ul class="space-y-2 text-sm">
                  {section.links.map((link) => {
                    const activityId = link.url.split('/').pop() || '';
                    const title = activityTitles.get(activityId);
                    const localizedUrl = lang === 'nl' ? link.url : `/${lang}${link.url}`;
                    return (
                      <li>
                        <a href={localizedUrl} class="hover:text-white transition-colors">
                          {title}
                        </a>
                      </li>
                    );
                  })}
                </ul>
              </div>
            ))
          }
        </div>
      </div>
    </div>

    {/* Bottom Bar */}
    <div class="mt-12 pt-8 border-t border-zinc-800">
      <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
        <p class="text-sm text-zinc-400">
          &copy; {new Date().getFullYear()} ActionMaker. {t('footer.rights-reserved')}
        </p>
        <div class="flex space-x-6">
          <a
            href={lang === 'nl' ? '/terms-of-service' : `/${lang}/terms-of-service`}
            class="text-sm text-zinc-400 hover:text-white transition-colors"
          >
            {t('footer.terms-of-service')}
          </a>
          <a
            href={lang === 'nl' ? '/disclaimer' : `/${lang}/disclaimer`}
            class="text-sm text-zinc-400 hover:text-white transition-colors"
          >
            {t('footer.disclaimer')}
          </a>
        </div>
      </div>
    </div>
  </div>
</footer>
