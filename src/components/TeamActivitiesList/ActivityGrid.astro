---
import { Card } from '@/components/ui/card';
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface TeamActivity {
  id: string;
  title: string;
  description: string;
  image: string;
  categories: string[];
}

interface Props {
  activities: TeamActivity[];
  imageImports: Record<string, { default: ImageMetadata }>;
}

const { activities, imageImports } = Astro.props;
---

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
  {
    activities.map((activity) => {
      const cleanId = activity.id.replace(/\.md$/, '');
      const href = `/teambuildings/${cleanId}`;
      const imagePath = `/src/assets/activities/${activity.image}`;

      if (!imageImports[imagePath]) {
        console.error(`Image not found: ${imagePath}`);
        return null;
      }

      return (
        <a href={href} class="block">
          <Card className="group overflow-hidden transition-all duration-300 hover:shadow-xl">
            <div class="relative h-72 overflow-hidden">
              <Image
                src={imageImports[imagePath].default}
                alt={activity.title}
                width={800}
                height={600}
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
              />
              <div class="absolute inset-0 bg-black/40 transition-opacity duration-300 group-hover:opacity-70" />
            </div>

            <div class="p-6">
              <h3 class="text-xl font-bold mb-2">{activity.title}</h3>
              <p class="text-sm text-muted-foreground line-clamp-2">{activity.description}</p>
            </div>
          </Card>
        </a>
      );
    })
  }
</div>
